---
import MarketingLayout from '@/layouts/MarketingLayout.astro';
import PageHeader from '@sections/content/PageHeader.astro';
import SecurityBadges from '@sections/pricing/SecurityBadges.astro';
import ValuesSection from '@sections/team/ValuesSection.astro';
import FAQSection from '@sections/content/FAQSection.astro';
import CTA from '@sections/marketing/CTA.astro';
import { Icon } from 'astro-icon/components';
import { siteConfig } from '@/config';

const certifications = [
  {
    name: 'Supabase (PostgreSQL + RLS)',
    icon: 'lucide:database',
    description:
      'Base de datos con Row Level Security para que cada cliente acceda solo a sus datos. Políticas de acceso definidas por aplicación.',
  },
  {
    name: 'Cloudflare (SSL + CDN)',
    icon: 'lucide:shield',
    description:
      'Dominio protegido con DNS, certificados SSL y CDN. Tráfico web cifrado y protección frente a amenazas comunes.',
  },
  {
    name: 'Wompi (pagos)',
    icon: 'lucide:credit-card',
    description:
      'Pasarela de pago que cumple estándares de seguridad para transacciones. No almacenamos datos de tarjetas.',
  },
  {
    name: 'Backups y disponibilidad',
    icon: 'lucide:refresh-cw',
    description:
      'Copias de seguridad en VPS (Hetzner) y almacenamiento Supabase. Infraestructura preparada para recuperación.',
  },
];

const securityFeatures = [
  {
    icon: 'lucide:lock',
    title: 'Cifrado en tránsito',
    description:
      'Toda la comunicación con la web y los servicios se realiza por HTTPS (TLS) gracias a Cloudflare y configuración en servidor. Los datos no viajan en claro.',
  },
  {
    icon: 'lucide:key',
    title: 'Control de acceso a datos',
    description:
      'Supabase utiliza Row Level Security (RLS) en PostgreSQL. Las consultas se filtran por usuario/tenant para que cada cliente solo vea su propia información.',
  },
  {
    icon: 'lucide:server',
    title: 'Infraestructura aislada',
    description:
      'Backend y automatizaciones (n8n, Evolution API, Budibase) se ejecutan en VPS (Hetzner) con Docker/Coolify y VPN (Tailscale), reduciendo superficie de exposición.',
  },
  {
    icon: 'lucide:file-check',
    title: 'Procesamiento de documentos con IA',
    description:
      'Los documentos que procesa el equipo de IA (Lucía, Sofía, María) se envían a proveedores con prácticas de seguridad y privacidad alineadas al uso empresarial.',
  },
  {
    icon: 'lucide:message-circle',
    title: 'Canal WhatsApp oficial',
    description:
      'Conexión con la API de WhatsApp de Meta para atención al cliente, con uso conforme a sus políticas de seguridad y privacidad.',
  },
  {
    icon: 'lucide:wallet',
    title: 'Pagos con Wompi',
    description:
      'Los pagos se procesan mediante Wompi (PSE, tarjetas). No almacenamos datos sensibles de medios de pago; la pasarela cumple estándares de la industria.',
  },
];

const securityFAQs = [
  {
    question: '¿Dónde se almacenan los datos de mi empresa?',
    answer:
      'Los datos de negocio y documentos se almacenan en Supabase (PostgreSQL) con políticas RLS. La infraestructura de procesos (n8n, dashboard) corre en un VPS dedicado con backups configurados.',
  },
  {
    question: '¿Cómo se protegen los datos en tránsito?',
    answer:
      'Todo el tráfico entre tu navegador y nuestros servicios utiliza HTTPS (TLS). El dominio está protegido con Cloudflare, que aporta SSL y capa de protección adicional.',
  },
  {
    question: '¿Quién puede ver la información de mi cuenta?',
    answer:
      'Solo tu organización tiene acceso a sus propios datos gracias a Row Level Security en la base de datos. Afinate accede únicamente cuando es necesario para soporte o mantenimiento, con criterios internos de confidencialidad.',
  },
  {
    question: '¿Cómo reportar una vulnerabilidad o incidente?',
    answer:
      'Puedes reportar vulnerabilidades o incidentes de seguridad a afinateia@gmail.com. Revisaremos cada reporte y te responderemos en un plazo razonable.',
  },
];
---

<MarketingLayout
  title={`Seguridad - ${siteConfig.name}`}
  description="Cómo afinate protege tus datos: stack técnico, cifrado, control de acceso y buenas prácticas."
>
  <PageHeader
    title="Seguridad"
    subtitle="Protegemos tus datos con un stack moderno: base de datos con control de acceso, cifrado en tránsito, pagos seguros e infraestructura aislada."
  />

  <SecurityBadges
    title="Garantías técnicas y cumplimiento"
    subtitle="Pilares de nuestra arquitectura para la seguridad y privacidad de la información."
    badges={certifications}
    variant="cards"
    background="muted"
  />

  <ValuesSection
    title="Cómo te protegemos"
    subtitle="Medidas de seguridad integradas en la plataforma y en la operación."
    items={securityFeatures}
    variant="with-icon"
    columns={2}
    background="default"
  />

  <section class="py-section bg-surface">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        <div>
          <h2 class="text-2xl sm:text-3xl font-bold text-text">Stack técnico y buenas prácticas</h2>
          <div class="mt-6 space-y-4 text-text-muted">
            <p>
              La web está construida con <strong class="text-text">Astro</strong> y se sirve de forma segura.
              Los datos y la lógica de negocio dependen de <strong class="text-text">Supabase</strong> (PostgreSQL con RLS,
              almacenamiento y backups). La capa de pago la gestiona <strong class="text-text">Wompi</strong>;
              el procesamiento de documentos con IA utiliza APIs de proveedores con compromisos de privacidad.
            </p>
            <p>
              Las automatizaciones, el dashboard
              y la conexión con <strong class="text-text">WhatsApp (Evolution API)</strong> se ejecutan en un
              <strong class="text-text">VPS (Hetzner)</strong> gestionado con <strong class="text-text">Docker y Coolify</strong>,
              accesible por <strong class="text-text">VPN (Tailscale)</strong> para reducir riesgos. El dominio está
              protegido con <strong class="text-text">Cloudflare</strong> (DNS, SSL y CDN).
            </p>
            <p>
              Nos comprometemos a mantener actualizado el stack, aplicar parches de seguridad y revisar el acceso
              a los sistemas. Si necesitas documentación específica o un cuestionario de seguridad, contáctanos.
            </p>
          </div>
          <div class="mt-8">
            <a
              href="/contact"
              class="inline-flex items-center gap-2 px-6 py-3 rounded-md bg-primary text-primary-foreground font-medium hover:bg-primary-dark transition-colors"
            >
              <Icon name="lucide:mail" class="w-5 h-5" />
              Solicitar información de seguridad
            </a>
          </div>
        </div>
        <div class="bg-background rounded-xl border border-border p-8">
          <h3 class="font-semibold text-text mb-6">Contacto de seguridad</h3>
          <div class="space-y-4">
            <div>
              <p class="text-sm text-text-muted">Reportar vulnerabilidad o incidente</p>
              <a href="mailto:afinateia@gmail.com" class="text-primary hover:underline">
                afinateia@gmail.com
              </a>
            </div>
            <div>
              <p class="text-sm text-text-muted">Cuestionarios o documentación</p>
              <a href="mailto:afinateia@gmail.com" class="text-primary hover:underline">
                afinateia@gmail.com
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <FAQSection
    title="Preguntas frecuentes de seguridad"
    subtitle="Respuestas sobre almacenamiento, cifrado y prácticas de afinate."
    faqs={securityFAQs}
    variant="accordion"
    background="default"
  />

  <CTA
    title="¿Necesitas más información?"
    description="Nuestro equipo está disponible para resolver dudas sobre seguridad, cumplimiento o requisitos específicos de tu organización."
    action={{ label: 'Contactar', href: '/contact' }}
    background="muted"
  />
</MarketingLayout>
