---
/**
 * Footer - Pie de p치gina con 4 columnas: Soluci칩n, Infraestructura, Legal, Empresa.
 * Careers, Testimonials, Changelog y Roadmap no se muestran.
 */
import { siteConfig } from '@/config';
import { Icon } from 'astro-icon/components';
import type { FeatureFlags, NavigationItem } from '@/lib/types';

const { features, social, contact, navigation } = siteConfig;
const { footer } = navigation;
const currentYear = new Date().getFullYear();

const filterByFeature = (items: NavigationItem[]) =>
  items.filter((item) => !item.feature || features[item.feature as keyof FeatureFlags]);

const solucionLinks = filterByFeature(footer.solucion);
const infraestructuraLinks = filterByFeature(footer.infraestructura);
const legalLinks = filterByFeature(footer.legal);
const empresaLinks = filterByFeature(footer.empresa);
---

<footer class="bg-surface border-t border-background">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-8 lg:gap-12">
      <!-- Brand -->
      <div class="col-span-2 sm:col-span-3 lg:col-span-2 mb-4 lg:mb-0">
        <a href="/" class="inline-flex items-center gap-2 font-semibold text-lg text-text">
          {
            siteConfig.logoLight && siteConfig.logoDark ? (
              <>
                <img
                  src={siteConfig.logoLight}
                  alt={siteConfig.name}
                  class="h-8 w-auto dark:hidden"
                  width="120"
                  height="32"
                />
                <img
                  src={siteConfig.logoDark}
                  alt={siteConfig.name}
                  class="h-8 w-auto hidden dark:block"
                  width="120"
                  height="32"
                />
              </>
            ) : siteConfig.logo ? (
              <img src={siteConfig.logo} alt={siteConfig.name} class="h-8 w-auto" />
            ) : (
              siteConfig.name
            )
          }
        </a>
        <p class="mt-3 text-sm text-text-muted max-w-xs">
          {siteConfig.description}
        </p>
        <div class="mt-4 space-y-1 text-sm text-text-muted">
          {
            contact.email && (
              <a href={`mailto:${contact.email}`} class="block hover:text-text transition-colors">
                {contact.email}
              </a>
            )
          }
          {
            contact.address && (
              <p>
                {contact.address.city}, {contact.address.state}, {contact.address.country}
              </p>
            )
          }
        </div>
        <div class="flex items-center gap-4 mt-4">
          {
            social.whatsapp && (
              <a
                href={social.whatsapp}
                target="_blank"
                rel="noopener noreferrer"
                aria-label="WhatsApp"
                class="text-text-muted hover:text-text transition-colors"
              >
                <Icon name="simple-icons:whatsapp" class="w-5 h-5" />
              </a>
            )
          }
          {
            social.instagram && (
              <a
                href={social.instagram}
                target="_blank"
                rel="noopener noreferrer"
                aria-label="Instagram"
                class="text-text-muted hover:text-text transition-colors"
              >
                <Icon name="simple-icons:instagram" class="w-5 h-5" />
              </a>
            )
          }
          {
            social.facebook && (
              <a
                href={social.facebook}
                target="_blank"
                rel="noopener noreferrer"
                aria-label="Facebook"
                class="text-text-muted hover:text-text transition-colors"
              >
                <Icon name="simple-icons:facebook" class="w-5 h-5" />
              </a>
            )
          }
          {
            social.x && (
              <a
                href={social.x}
                target="_blank"
                rel="noopener noreferrer"
                aria-label="X (Twitter)"
                class="text-text-muted hover:text-text transition-colors"
              >
                <Icon name="simple-icons:x" class="w-5 h-5" />
              </a>
            )
          }
        </div>
      </div>

      <!-- Soluci칩n -->
      {
        solucionLinks.length > 0 && (
          <div>
            <h3 class="font-semibold text-sm text-text mb-4">Soluci칩n</h3>
            <ul class="space-y-3">
              {solucionLinks.map((link) => (
                <li>
                  <a
                    href={link.href}
                    class="text-sm text-text-muted hover:text-text transition-colors"
                  >
                    {link.label}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        )
      }

      <!-- Infraestructura -->
      {
        infraestructuraLinks.length > 0 && (
          <div>
            <h3 class="font-semibold text-sm text-text mb-4">Infraestructura</h3>
            <ul class="space-y-3">
              {infraestructuraLinks.map((link) => (
                <li>
                  <a
                    href={link.href}
                    class="text-sm text-text-muted hover:text-text transition-colors"
                  >
                    {link.label}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        )
      }

      <!-- Legal -->
      {
        legalLinks.length > 0 && (
          <div>
            <h3 class="font-semibold text-sm text-text mb-4">Legal</h3>
            <ul class="space-y-3">
              {legalLinks.map((link) => (
                <li>
                  <a
                    href={link.href}
                    class="text-sm text-text-muted hover:text-text transition-colors"
                  >
                    {link.label}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        )
      }

      <!-- Empresa -->
      {
        empresaLinks.length > 0 && (
          <div>
            <h3 class="font-semibold text-sm text-text mb-4">Empresa</h3>
            <ul class="space-y-3">
              {empresaLinks.map((link) => (
                <li>
                  <a
                    href={link.href}
                    class="text-sm text-text-muted hover:text-text transition-colors"
                  >
                    {link.label}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        )
      }
    </div>

    <div class="mt-12 pt-8 border-t border-background">
      <div
        class="flex flex-col items-center md:flex-row md:justify-between gap-4 text-center md:text-left"
      >
        <p class="text-sm text-text-muted">
          &copy; {currentYear}
          {siteConfig.name}. Todos los derechos reservados.
        </p>
        <div class="flex items-center gap-6">
          {
            legalLinks.map((link) => (
              <a href={link.href} class="text-sm text-text-muted hover:text-text transition-colors">
                {link.label}
              </a>
            ))
          }
        </div>
      </div>
    </div>
  </div>
</footer>
